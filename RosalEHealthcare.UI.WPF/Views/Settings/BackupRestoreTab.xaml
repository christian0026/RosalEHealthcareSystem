<UserControl x:Class="RosalEHealthcare.UI.WPF.Views.Settings.BackupRestoreTab"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
             mc:Ignorable="d" 
             d:DesignHeight="800" d:DesignWidth="900"
             Background="White">

    <UserControl.Resources>
        <!-- Section Card Style -->
        <Style x:Key="SectionCard" TargetType="Border">
            <Setter Property="Background" Value="#FAFAFA"/>
            <Setter Property="BorderBrush" Value="#E8E8E8"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
        </Style>

        <!-- Section Title Style -->
        <Style x:Key="SectionTitle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="Margin" Value="0,0,0,4"/>
        </Style>

        <!-- Section Subtitle Style -->
        <Style x:Key="SectionSubtitle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#888888"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
        </Style>

        <!-- Field Label Style -->
        <Style x:Key="FieldLabel" TargetType="TextBlock">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Foreground" Value="#555555"/>
            <Setter Property="Margin" Value="0,0,0,6"/>
        </Style>

        <!-- Text Input Style -->
        <Style x:Key="TextInput" TargetType="TextBox">
            <Setter Property="Height" Value="40"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#D0D0D0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="6">
                            <ScrollViewer x:Name="PART_ContentHost" 
                                          Padding="{TemplateBinding Padding}"
                                          VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter Property="BorderBrush" Value="#2E7D32"/>
                                <Setter Property="BorderThickness" Value="2"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ComboBox Style -->
        <Style x:Key="ComboInput" TargetType="ComboBox">
            <Setter Property="Height" Value="40"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#D0D0D0"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <!-- Primary Button Style -->
        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Background" Value="#2E7D32"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="24,12"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                Padding="{TemplateBinding Padding}"
                                CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#388E3C"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#1B5E20"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Background" Value="#BDBDBD"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Secondary Button Style -->
        <Style x:Key="SecondaryButton" TargetType="Button">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="#666666"/>
            <Setter Property="Padding" Value="24,12"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="BorderBrush" Value="#D0D0D0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}"
                                CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#F5F5F5"/>
                                <Setter TargetName="border" Property="BorderBrush" Value="#BDBDBD"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#EEEEEE"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Danger Button Style -->
        <Style x:Key="DangerButton" TargetType="Button">
            <Setter Property="Background" Value="#F44336"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="24,12"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                Padding="{TemplateBinding Padding}"
                                CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#E53935"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#C62828"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Background" Value="#BDBDBD"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Toggle Switch Style -->
        <Style x:Key="ToggleSwitch" TargetType="CheckBox">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <StackPanel Orientation="Horizontal">
                            <Grid Width="50" Height="26">
                                <Border x:Name="track"
                                        Background="#E0E0E0"
                                        CornerRadius="13"
                                        Cursor="Hand"/>
                                <Border x:Name="thumb"
                                        Width="22" Height="22"
                                        CornerRadius="11"
                                        Background="White"
                                        HorizontalAlignment="Left"
                                        Margin="2,0,0,0"
                                        Cursor="Hand">
                                    <Border.Effect>
                                        <DropShadowEffect Color="#000000" BlurRadius="4" ShadowDepth="1" Opacity="0.2"/>
                                    </Border.Effect>
                                </Border>
                            </Grid>
                            <ContentPresenter Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="track" Property="Background" Value="#4CAF50"/>
                                <Setter TargetName="thumb" Property="HorizontalAlignment" Value="Right"/>
                                <Setter TargetName="thumb" Property="Margin" Value="0,0,2,0"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Info Card Style -->
        <Style x:Key="InfoCard" TargetType="Border">
            <Setter Property="Background" Value="#E3F2FD"/>
            <Setter Property="BorderBrush" Value="#90CAF9"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
        </Style>

        <!-- Warning Card Style -->
        <Style x:Key="WarningCard" TargetType="Border">
            <Setter Property="Background" Value="#FFF3E0"/>
            <Setter Property="BorderBrush" Value="#FFCC80"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
        </Style>

        <!-- Backup History Row Style -->
        <Style x:Key="BackupHistoryRow" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#EEEEEE"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="Padding" Value="12,10"/>
        </Style>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" 
                  HorizontalScrollBarVisibility="Disabled"
                  Padding="24">
        <StackPanel>

            <!-- LAST BACKUP INFO -->
            <Border Style="{StaticResource InfoCard}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <iconPacks:PackIconMaterial Kind="InformationOutline" 
                                                Width="24" Height="24" 
                                                Foreground="#1976D2"
                                                VerticalAlignment="Center"
                                                Margin="0,0,12,0"/>
                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock x:Name="TxtLastBackupInfo"
                                   Text="Last Backup: Never" 
                                   FontSize="14" 
                                   FontWeight="Medium" 
                                   Foreground="#1976D2"/>
                        <TextBlock x:Name="TxtBackupStats"
                                   Text="Total backups: 0 | Total size: 0 MB" 
                                   FontSize="12" 
                                   Foreground="#64B5F6"
                                   Margin="0,4,0,0"/>
                    </StackPanel>
                    <Button Grid.Column="2" 
                            x:Name="BtnRefreshStats"
                            Style="{StaticResource SecondaryButton}"
                            Padding="12,8"
                            Click="BtnRefreshStats_Click">
                        <iconPacks:PackIconMaterial Kind="Refresh" Width="16" Height="16"/>
                    </Button>
                </Grid>
            </Border>

            <!-- BACKUP CONFIGURATION Section -->
            <Border Style="{StaticResource SectionCard}">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                        <iconPacks:PackIconMaterial Kind="Cog" 
                                                    Width="20" Height="20" 
                                                    Foreground="#FF9800"
                                                    VerticalAlignment="Center"/>
                        <TextBlock Text="Backup Configuration" 
                                   Style="{StaticResource SectionTitle}"
                                   Margin="10,0,0,0"/>
                    </StackPanel>
                    <TextBlock Text="Configure backup location and options" 
                               Style="{StaticResource SectionSubtitle}"/>

                    <!-- Backup Location -->
                    <StackPanel Margin="0,0,0,16">
                        <TextBlock Text="Backup Location" Style="{StaticResource FieldLabel}"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBox x:Name="TxtBackupLocation" 
                                     Style="{StaticResource TextInput}"
                                     IsReadOnly="True"/>
                            <Button Grid.Column="1" 
                                    x:Name="BtnBrowseLocation"
                                    Style="{StaticResource SecondaryButton}"
                                    Padding="16,8"
                                    Margin="8,0,0,0"
                                    Click="BtnBrowseLocation_Click">
                                <StackPanel Orientation="Horizontal">
                                    <iconPacks:PackIconMaterial Kind="FolderOpen" Width="16" Height="16"/>
                                    <TextBlock Text="Browse" Margin="8,0,0,0"/>
                                </StackPanel>
                            </Button>
                        </Grid>
                    </StackPanel>

                    <!-- Retention Count -->
                    <Grid Margin="0,0,0,16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="200"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0" VerticalAlignment="Center">
                            <TextBlock Text="Backup Retention" 
                                       FontSize="14" 
                                       FontWeight="Medium" 
                                       Foreground="#333"/>
                            <TextBlock Text="Number of backups to keep (older ones are auto-deleted)" 
                                       FontSize="12" 
                                       Foreground="#888"
                                       Margin="0,4,0,0"/>
                        </StackPanel>
                        <ComboBox x:Name="CmbRetentionCount" 
                                  Grid.Column="1"
                                  Style="{StaticResource ComboInput}">
                            <ComboBoxItem Content="Keep last 5" Tag="5"/>
                            <ComboBoxItem Content="Keep last 10" Tag="10"/>
                            <ComboBoxItem Content="Keep last 20" Tag="20"/>
                            <ComboBoxItem Content="Keep last 50" Tag="50"/>
                            <ComboBoxItem Content="Keep all" Tag="999"/>
                        </ComboBox>
                    </Grid>

                    <!-- Save Config Button -->
                    <Button x:Name="BtnSaveConfig" 
                            Style="{StaticResource SecondaryButton}"
                            HorizontalAlignment="Left"
                            Click="BtnSaveConfig_Click">
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconMaterial Kind="ContentSave" Width="16" Height="16"/>
                            <TextBlock Text="Save Configuration" Margin="8,0,0,0"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Border>

            <!-- CREATE BACKUP Section -->
            <Border Style="{StaticResource SectionCard}">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                        <iconPacks:PackIconMaterial Kind="DatabaseExport" 
                                                    Width="20" Height="20" 
                                                    Foreground="#4CAF50"
                                                    VerticalAlignment="Center"/>
                        <TextBlock Text="Create Backup" 
                                   Style="{StaticResource SectionTitle}"
                                   Margin="10,0,0,0"/>
                    </StackPanel>
                    <TextBlock Text="Create a new database backup" 
                               Style="{StaticResource SectionSubtitle}"/>

                    <!-- Progress Panel (Hidden by default) -->
                    <Border x:Name="BackupProgressPanel" 
                            Background="#F5F5F5" 
                            CornerRadius="8" 
                            Padding="16" 
                            Margin="0,0,0,16"
                            Visibility="Collapsed">
                        <StackPanel>
                            <Grid Margin="0,0,0,8">
                                <TextBlock x:Name="TxtBackupProgress" 
                                           Text="Preparing backup..." 
                                           FontSize="14" 
                                           FontWeight="Medium"/>
                                <TextBlock x:Name="TxtBackupPercent" 
                                           Text="0%" 
                                           FontSize="14" 
                                           FontWeight="Medium"
                                           HorizontalAlignment="Right"/>
                            </Grid>
                            <ProgressBar x:Name="BackupProgressBar" 
                                         Height="8" 
                                         Minimum="0" 
                                         Maximum="100" 
                                         Value="0"
                                         Foreground="#4CAF50"/>
                        </StackPanel>
                    </Border>

                    <!-- Create Backup Button -->
                    <Button x:Name="BtnCreateBackup" 
                            Style="{StaticResource PrimaryButton}"
                            HorizontalAlignment="Left"
                            Click="BtnCreateBackup_Click">
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconMaterial Kind="DatabasePlus" Width="18" Height="18"/>
                            <TextBlock Text="Create Backup Now" Margin="10,0,0,0"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Border>

            <!-- RESTORE DATABASE Section -->
            <Border Style="{StaticResource SectionCard}">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                        <iconPacks:PackIconMaterial Kind="DatabaseImport" 
                                                    Width="20" Height="20" 
                                                    Foreground="#F44336"
                                                    VerticalAlignment="Center"/>
                        <TextBlock Text="Restore Database" 
                                   Style="{StaticResource SectionTitle}"
                                   Margin="10,0,0,0"/>
                    </StackPanel>
                    <TextBlock Text="Restore database from a backup file" 
                               Style="{StaticResource SectionSubtitle}"/>

                    <!-- Warning -->
                    <Border Style="{StaticResource WarningCard}">
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconMaterial Kind="AlertOutline" 
                                                        Width="20" Height="20" 
                                                        Foreground="#EF6C00"
                                                        VerticalAlignment="Top"
                                                        Margin="0,2,12,0"/>
                            <TextBlock TextWrapping="Wrap" Foreground="#E65100">
                                <Run FontWeight="SemiBold">Warning:</Run>
                                <Run>Restoring a backup will replace ALL current data with the data from the backup file. This action cannot be undone. The application will need to be restarted after restore.</Run>
                            </TextBlock>
                        </StackPanel>
                    </Border>

                    <!-- Restore Progress Panel (Hidden by default) -->
                    <Border x:Name="RestoreProgressPanel" 
                            Background="#FFEBEE" 
                            CornerRadius="8" 
                            Padding="16" 
                            Margin="0,0,0,16"
                            Visibility="Collapsed">
                        <StackPanel>
                            <Grid Margin="0,0,0,8">
                                <TextBlock x:Name="TxtRestoreProgress" 
                                           Text="Preparing restore..." 
                                           FontSize="14" 
                                           FontWeight="Medium"
                                           Foreground="#C62828"/>
                                <TextBlock x:Name="TxtRestorePercent" 
                                           Text="0%" 
                                           FontSize="14" 
                                           FontWeight="Medium"
                                           Foreground="#C62828"
                                           HorizontalAlignment="Right"/>
                            </Grid>
                            <ProgressBar x:Name="RestoreProgressBar" 
                                         Height="8" 
                                         Minimum="0" 
                                         Maximum="100" 
                                         Value="0"
                                         Foreground="#F44336"/>
                        </StackPanel>
                    </Border>

                    <!-- Restore Button -->
                    <Button x:Name="BtnRestoreBackup" 
                            Style="{StaticResource DangerButton}"
                            HorizontalAlignment="Left"
                            Click="BtnRestoreBackup_Click">
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconMaterial Kind="DatabaseSync" Width="18" Height="18"/>
                            <TextBlock Text="Select Backup File and Restore" Margin="10,0,0,0"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Border>

            <!-- BACKUP HISTORY Section -->
            <Border Style="{StaticResource SectionCard}">
                <StackPanel>
                    <Grid Margin="0,0,0,16">
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconMaterial Kind="History" 
                                                        Width="20" Height="20" 
                                                        Foreground="#2196F3"
                                                        VerticalAlignment="Center"/>
                            <TextBlock Text="Backup History" 
                                       Style="{StaticResource SectionTitle}"
                                       Margin="10,0,0,0"/>
                        </StackPanel>
                        <Button x:Name="BtnRefreshHistory" 
                                Style="{StaticResource SecondaryButton}"
                                Padding="12,6"
                                HorizontalAlignment="Right"
                                Click="BtnRefreshHistory_Click">
                            <StackPanel Orientation="Horizontal">
                                <iconPacks:PackIconMaterial Kind="Refresh" Width="14" Height="14"/>
                                <TextBlock Text="Refresh" Margin="6,0,0,0" FontSize="12"/>
                            </StackPanel>
                        </Button>
                    </Grid>

                    <!-- History Table -->
                    <Border Background="White" 
                            BorderBrush="#E0E0E0" 
                            BorderThickness="1" 
                            CornerRadius="8">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Header -->
                            <Border Grid.Row="0" 
                                    Background="#F5F5F5" 
                                    Padding="12,10"
                                    CornerRadius="8,8,0,0">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="40"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="140"/>
                                        <ColumnDefinition Width="120"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="" FontWeight="SemiBold" FontSize="12" Foreground="#555"/>
                                    <TextBlock Grid.Column="1" Text="File Name" FontWeight="SemiBold" FontSize="12" Foreground="#555"/>
                                    <TextBlock Grid.Column="2" Text="Size" FontWeight="SemiBold" FontSize="12" Foreground="#555"/>
                                    <TextBlock Grid.Column="3" Text="Type" FontWeight="SemiBold" FontSize="12" Foreground="#555"/>
                                    <TextBlock Grid.Column="4" Text="Created" FontWeight="SemiBold" FontSize="12" Foreground="#555"/>
                                    <TextBlock Grid.Column="5" Text="Actions" FontWeight="SemiBold" FontSize="12" Foreground="#555" HorizontalAlignment="Center"/>
                                </Grid>
                            </Border>

                            <!-- History Items -->
                            <ItemsControl x:Name="BackupHistoryList" 
                                          Grid.Row="1"
                                          MaxHeight="300">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <StackPanel/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Style="{StaticResource BackupHistoryRow}">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="40"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="100"/>
                                                    <ColumnDefinition Width="80"/>
                                                    <ColumnDefinition Width="140"/>
                                                    <ColumnDefinition Width="120"/>
                                                </Grid.ColumnDefinitions>

                                                <!-- Status Icon -->
                                                <TextBlock Grid.Column="0" 
                                                           Text="{Binding StatusIcon}" 
                                                           FontSize="16"
                                                           HorizontalAlignment="Center"/>

                                                <!-- File Name -->
                                                <TextBlock Grid.Column="1" 
                                                           Text="{Binding FileName}" 
                                                           FontSize="13"
                                                           VerticalAlignment="Center"
                                                           TextTrimming="CharacterEllipsis"/>

                                                <!-- Size -->
                                                <TextBlock Grid.Column="2" 
                                                           Text="{Binding FileSizeFormatted}" 
                                                           FontSize="13"
                                                           Foreground="#666"
                                                           VerticalAlignment="Center"/>

                                                <!-- Type -->
                                                <TextBlock Grid.Column="3" 
                                                           Text="{Binding BackupType}" 
                                                           FontSize="12"
                                                           Foreground="#888"
                                                           VerticalAlignment="Center"/>

                                                <!-- Created Date -->
                                                <TextBlock Grid.Column="4" 
                                                           Text="{Binding StartedAt, StringFormat='{}{0:MM/dd/yyyy HH:mm}'}" 
                                                           FontSize="12"
                                                           Foreground="#666"
                                                           VerticalAlignment="Center"/>

                                                <!-- Actions -->
                                                <StackPanel Grid.Column="5" 
                                                            Orientation="Horizontal" 
                                                            HorizontalAlignment="Center">
                                                    <Button ToolTip="Restore from this backup"
                                                            Background="Transparent"
                                                            BorderThickness="0"
                                                            Padding="8,4"
                                                            Cursor="Hand"
                                                            Tag="{Binding}"
                                                            Click="BtnRestoreFromHistory_Click">
                                                        <iconPacks:PackIconMaterial Kind="DatabaseSync" 
                                                                                    Width="16" Height="16" 
                                                                                    Foreground="#2196F3"/>
                                                    </Button>
                                                    <Button ToolTip="Open folder"
                                                            Background="Transparent"
                                                            BorderThickness="0"
                                                            Padding="8,4"
                                                            Cursor="Hand"
                                                            Tag="{Binding}"
                                                            Click="BtnOpenFolder_Click">
                                                        <iconPacks:PackIconMaterial Kind="FolderOpen" 
                                                                                    Width="16" Height="16" 
                                                                                    Foreground="#FF9800"/>
                                                    </Button>
                                                    <Button ToolTip="Delete backup"
                                                            Background="Transparent"
                                                            BorderThickness="0"
                                                            Padding="8,4"
                                                            Cursor="Hand"
                                                            Tag="{Binding}"
                                                            Click="BtnDeleteBackup_Click">
                                                        <iconPacks:PackIconMaterial Kind="Delete" 
                                                                                    Width="16" Height="16" 
                                                                                    Foreground="#F44336"/>
                                                    </Button>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>

                            <!-- Empty State -->
                            <Border x:Name="EmptyHistoryPanel" 
                                    Grid.Row="1" 
                                    Padding="40"
                                    Visibility="Collapsed">
                                <StackPanel HorizontalAlignment="Center">
                                    <iconPacks:PackIconMaterial Kind="DatabaseOff" 
                                                                Width="48" Height="48" 
                                                                Foreground="#BDBDBD"
                                                                HorizontalAlignment="Center"/>
                                    <TextBlock Text="No backups found" 
                                               FontSize="14" 
                                               Foreground="#888"
                                               HorizontalAlignment="Center"
                                               Margin="0,12,0,0"/>
                                    <TextBlock Text="Create your first backup to get started" 
                                               FontSize="12" 
                                               Foreground="#AAA"
                                               HorizontalAlignment="Center"
                                               Margin="0,4,0,0"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Border>
                </StackPanel>
            </Border>

        </StackPanel>
    </ScrollViewer>
</UserControl>